require 'autotest/growl'

Autotest.add_hook :initialize do |at|
  at.clear_mappings
  %w{.svn .hg .git}.each {|exception|at.add_exception(exception)}

  
  at.add_mapping %r%^spec/(.*)_spec\.rb% do |f, _|
    f
  end

  at.add_mapping %r%^lib/(.*)\.rb% do |_, m|
    possible = File.basename(m[1])
    dirname  = File.dirname(m[1])
    at.files_matching(%r%spec/lib/#{possible}_spec\.rb%) + 
       at.files_matching(%r%spec/lib/#{dirname}/#{possible}_spec\.rb%)
  end
  

end